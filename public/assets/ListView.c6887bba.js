import{z as Y,d as A,s as B,c as Z,r as y,o as tt,u as x,A as E,a as r,b as v,f as e,h as i,e as a,g as s,i as m,v as f,j as k,F,k as et,t as V,B as st,D as ot,E as nt,G as it,l as at,U as lt,n as c,H as ut,p as ct,q as rt,_ as dt,T as _t,x as mt}from"./index.1ba03ace.js";import pt from"./TheError.ebf935e5.js";const ht=Y("human",{state:()=>({list:{page:0,total:0,limit:20,isLoading:!1,humansList:[],selectedSort:null,searchQuery:""}}),getters:{sortedHumansList(o){return typeof o.list.selectedSort=="string"?[...o.list.humansList].sort((u,p)=>{var t;return(t=u[o.list.selectedSort])==null?void 0:t.localeCompare(p[o.list.selectedSort])}):o.list.humansList},sortedAndSearchedHumansList(){return[...this.sortedHumansList].filter(o=>o.fio.includes(this.list.searchQuery))}}}),D=o=>(ct("data-v-4732c953"),o=o(),rt(),o),vt=D(()=>a("h2",{style:{"text-align":"center"}},"\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?",-1)),ft={class:"buttons"},gt={class:"buttons_load"},Lt={class:"buttons_load"},bt={class:"container"},yt=D(()=>a("h1",{class:"title",style:{"margin-bottom":"10px"}},"\u041F\u043E\u043B\u043D\u044B\u0439 \u0441\u043F\u0438\u0441\u043E\u043A",-1)),kt={style:{padding:"5px 0"}},Ht={class:"list_number",style:{padding:"0 10px"}},Ct={class:"list_buttons"},St={key:0,class:"loading"},wt={class:"observer"},xt=A({__name:"HumansList",setup(o){const u=B(),p=at(),t=ht(),T=Z(()=>t.list.page<t.list.total&&!C.value),g=y(!1),L=y(""),M=y([{value:"_id",title:"\u041F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E"},{value:"fio",title:"\u041F\u043E \u0444\u0430\u043C\u0438\u043B\u0438\u0438"}]);tt(()=>{t.list.humansList.length||H()});const{fetchFunc:H,isLoading:C,error:$}=x({callback:Q,alert:!1}),{fetchFunc:I,isLoading:N}=x({callback:U,successMessage:"\u0423\u0434\u0430\u043B\u0435\u043D\u043E"});async function Q(){$.value="",t.list.page++;const n=await E.catchHumansList({limit:t.list.limit,page:t.list.page});if(t.list.total=Math.ceil(+n.headers["x-total-count"]/t.list.limit),t.list.humansList=[...t.list.humansList,...n.data.humansList],!t.list.humansList.length)throw new Error("\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0443\u0441\u0442")}async function U(){await E.deleteHuman(L.value),h(),t.list.humansList=t.list.humansList.filter(n=>n._id!==L.value)}function h(n){g.value=!g.value,n&&(L.value=n)}function W(n){u.alert.isVisible&&u.showAlert(!1),lt.copyToClipboard(n).then(d=>{u.setAlert("success",d),u.showAlert(!0)})}function q(n){p.push({path:"/info",query:{search:n}})}return(n,d)=>{const S=c("v-btn"),w=c("LoadingWheel"),z=c("ModalWindow"),G=c("v-select"),P=c("v-text-field"),b=c("v-icon"),R=c("v-tooltip"),j=c("v-list-item-title"),O=c("v-list-item"),J=c("v-list"),K=ut("intersection");return r(),v(F,null,[e(z,{show:g.value,onHide:h},{default:i(()=>[vt,a("div",ft,[a("div",gt,[e(S,{class:"confirm",onClick:s(I)},{default:i(()=>[m("\u0414\u0430")]),_:1},8,["onClick"]),s(N)?(r(),f(w,{key:0,class:"wheel"})):k("",!0)]),a("div",Lt,[e(S,{class:"confirm",onClick:h},{default:i(()=>[m("\u041D\u0435\u0442")]),_:1})])])]),_:1},8,["show"]),a("div",bt,[yt,a("div",kt,[e(G,{label:"\u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",items:M.value,modelValue:s(t).list.selectedSort,"onUpdate:modelValue":d[0]||(d[0]=l=>s(t).list.selectedSort=l),variant:"solo"},null,8,["items","modelValue"]),e(P,{label:"\u041F\u043E\u0438\u0441\u043A",modelValue:s(t).list.searchQuery,"onUpdate:modelValue":d[1]||(d[1]=l=>s(t).list.searchQuery=l),variant:"solo"},null,8,["modelValue"])]),s(t).sortedAndSearchedHumansList.length?(r(),f(J,{key:0,class:"list"},{default:i(()=>[e(nt,{name:"list"},{default:i(()=>[(r(!0),v(F,null,et(s(t).sortedAndSearchedHumansList,(l,X)=>(r(),f(O,{class:"list_item",key:l._id},{prepend:i(()=>[a("div",Ht,V(X+1+"."),1)]),append:i(()=>[a("div",Ct,[e(b,{class:"item_button",tag:"button",onClick:_=>W(l.fio)},{default:i(()=>[m("mdi-content-copy")]),_:2},1032,["onClick"]),e(b,{class:"item_button",tag:"button",onClick:_=>q(l.fio)},{default:i(()=>[m("mdi-magnify")]),_:2},1032,["onClick"]),e(b,{class:"item_button",tag:"button",onClick:_=>h(l._id)},{default:i(()=>[m("mdi-delete-forever")]),_:2},1032,["onClick"])])]),default:i(()=>[e(j,{class:"list_title",onClick:_=>n.$router.push(`/list/${l._id}`)},{default:i(()=>[e(R,{text:l.fio,location:"bottom"},{activator:i(({props:_})=>[a("span",st(ot(_)),V(l.fio),17)]),_:2},1032,["text"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})):k("",!0)]),s(C)?(r(),v("div",St,[e(w)])):k("",!0),a("div",wt,[it(a("div",null,null,512),[[K,{f:s(H),canLoad:()=>s(T)}]])])],64)}}});const Et=dt(xt,[["__scopeId","data-v-4732c953"]]),Ft={key:1},Vt={class:"content"},Dt=A({__name:"ListView",setup(o){const u=B();return(p,t)=>s(u).isAdmin?(r(),v("div",Ft,[e(_t,{onShow:s(u).setMenuVisible,onTheme:s(u).setTheme},null,8,["onShow","onTheme"]),e(mt),a("div",Vt,[e(Et)])])):(r(),f(pt,{key:0,code:403,message:"Forbidden"}))}});export{Dt as default};
