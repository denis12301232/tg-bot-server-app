import{_ as B,u as G,C as Z}from"./index.2d61b0ad.js";import q from"./TheError.8d836bc1.js";import{j as x,a as j,h as K,$ as c,W as r,U as b,y as o,X as e,_ as E,Q as T,u as i,a5 as D,V as U,Z as k,a2 as H,r as $,w as J,F as W,a4 as Q,I as w,K as S,a7 as P,a8 as M,E as ee,Y as A}from"./@vue.6acdfb34.js";import{u as te}from"./useNavigation.8e3f35ed.js";import{u as F}from"./useFetching.28e2ee03.js";import{T as R}from"./ToolsService.7b451d73.js";import{A as se}from"./AssistanceService.be5eaf50.js";import"./pinia.6b015bcc.js";import"./vue-demi.b3a9cad9.js";import"./vuetify.e3688c29.js";import"./axios.0e4a87d2.js";import"./form-data.2b153385.js";import"./vue-router.cd563335.js";/* empty css             */import"./core-js.40dbafa1.js";const ue={class:"google_control"},oe={class:"google_message"},le=x({__name:"TheToolsGoogle",setup(n){const t=j({serviceUser:"",servicePrivateKey:"",sheetId:"",folderId:"",message:""}),s=K(()=>!t.serviceUser&&!t.servicePrivateKey&&!t.sheetId&&!t.folderId),{fetchFunc:u,isLoading:_}=F({callback:l,successMessage:"\u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E"});async function l(){await R.setGoogleServiceAccountSettings(t.serviceUser,t.servicePrivateKey,t.sheetId,t.folderId),t.serviceUser="",t.servicePrivateKey="",t.sheetId="",t.folderId=""}return(p,a)=>{const V=c("v-text-field"),f=c("v-btn"),h=c("LoadingWheel");return r(),b("form",{class:"google",onSubmit:a[4]||(a[4]=H((...m)=>i(u)&&i(u)(...m),["prevent"]))},[o(V,{modelValue:t.serviceUser,"onUpdate:modelValue":a[0]||(a[0]=m=>t.serviceUser=m),variant:"outlined",label:"Service account email"},null,8,["modelValue"]),o(V,{modelValue:t.servicePrivateKey,"onUpdate:modelValue":a[1]||(a[1]=m=>t.servicePrivateKey=m),variant:"outlined",label:"Service account private key"},null,8,["modelValue"]),o(V,{modelValue:t.sheetId,"onUpdate:modelValue":a[2]||(a[2]=m=>t.sheetId=m),variant:"outlined",label:"Sheet ID"},null,8,["modelValue"]),o(V,{modelValue:t.folderId,"onUpdate:modelValue":a[3]||(a[3]=m=>t.folderId=m),variant:"outlined",label:"Folder ID"},null,8,["modelValue"]),e("div",ue,[o(f,{type:"submit",disabled:i(s)},{default:E(()=>[T("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C")]),_:1},8,["disabled"]),i(_)?(r(),D(h,{key:0})):U("",!0),e("div",oe,k(t.message),1)])],32)}}});const ae=B(le,[["__scopeId","data-v-6b80d342"]]),N=n=>(P("data-v-d439015b"),n=n(),M(),n),ne={class:"filter_container"},ie=N(()=>e("h3",{class:"filter_title"},"\u041A\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u0432\u044B\u0433\u0440\u0443\u0437\u043A\u0438",-1)),de={class:"filter_content"},ce={class:"item_title"},re={class:"filter"},_e=N(()=>e("h4",{class:"filter_title"},"\u0420\u0430\u0439\u043E\u043D",-1)),me={class:"filter"},ve=N(()=>e("h4",{class:"filter_title"},"\u0413\u043E\u0434 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F",-1)),pe={class:"buttons"},he=["href"],fe=x({__name:"TheToolsSheets",setup(n){const t=G(),s=$([]),u=$([1920,2022]),_=$(""),l=$(null),p=K(()=>s.value.length?s.value.includes("district")&&s.value.includes("birth")?f.value||!l.value||!u.value[0]||!u.value[1]:f.value||!l.value&&(!u.value[0]||!u.value[1]):!0),a=[{name:"\u041F\u043E \u0440\u0430\u0439\u043E\u043D\u0443",value:"district"},{name:"\u041F\u043E \u0433\u043E\u0434\u0443",value:"birth"}],{fetchFunc:V,isLoading:f,data:h}=F({callback:m,successMessage:"\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u043E"});async function m(){_.value="";const C={district:l.value,birth:{from:u.value[0],to:u.value[1]||9999}};return await se.saveFormsToSheet(C)}return J(h,()=>{var C;_.value=((C=h.value)==null?void 0:C.link)||""}),(C,v)=>{const I=c("CCheckbox"),d=c("v-select"),y=c("v-text-field"),z=c("v-range-slider"),O=c("v-btn"),X=c("LoadingWheel");return r(),b("div",ne,[ie,e("div",de,[(r(),b(W,null,Q(a,g=>e("div",{class:"filter_item",key:g.name},[e("header",ce,k(g.name),1),o(I,{modelValue:s.value,"onUpdate:modelValue":v[0]||(v[0]=Y=>s.value=Y),value:g.value,theme:i(t).currentTheme},null,8,["modelValue","value","theme"])])),64))]),w(e("div",re,[_e,o(d,{modelValue:l.value,"onUpdate:modelValue":v[1]||(v[1]=g=>l.value=g),label:"\u0420\u0430\u0439\u043E\u043D",items:i(Z).districts},null,8,["modelValue","items"])],512),[[S,s.value.includes("district")]]),w(e("div",me,[ve,o(z,{min:"1920",max:"2022",step:"1",modelValue:u.value,"onUpdate:modelValue":v[4]||(v[4]=g=>u.value=g)},{prepend:E(()=>[o(y,{modelValue:u.value[0],"onUpdate:modelValue":v[2]||(v[2]=g=>u.value[0]=g),"hide-details":"","single-line":"",type:"number",variant:"outlined",density:"compact",style:{width:"85px"}},null,8,["modelValue"])]),append:E(()=>[o(y,{modelValue:u.value[1],"onUpdate:modelValue":v[3]||(v[3]=g=>u.value[1]=g),"hide-details":"","single-line":"",type:"number",variant:"outlined",style:{width:"85px"},density:"compact"},null,8,["modelValue"])]),_:1},8,["modelValue"])],512),[[S,s.value.includes("birth")]]),e("div",pe,[o(O,{onClick:i(V),disabled:i(p)},{default:E(()=>[T("\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1},8,["onClick","disabled"]),i(f)?(r(),D(X,{key:0})):U("",!0)]),_.value?(r(),b("a",{key:0,class:"sheets_link",target:"_blank",href:_.value},"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u0432\u044B\u0433\u0440\u0443\u0436\u0435\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438",8,he)):U("",!0)])}}});const ge=B(fe,[["__scopeId","data-v-d439015b"]]),L=n=>(P("data-v-1285b9d7"),n=n(),M(),n),be={key:0,class:"loader"},Ve=L(()=>e("span",null,null,-1)),Ce={key:1,class:"content"},ye={class:"user_list"},Te=L(()=>e("tr",{class:"list_header"},[e("th",null,"\u0418\u043C\u044F"),e("th",null,"\u0415-\u043C\u044D\u0439\u043B"),e("th",null,"\u0420\u043E\u043B\u044C")],-1)),Ee={class:"list_row"},ke={class:"row_item"},$e={class:"row_item"},De={class:"roles"},xe=L(()=>e("label",{class:"role_name"},"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",-1)),Ie={class:"roles"},Ue=L(()=>e("label",{class:"role_name"},"\u0410\u0434\u043C\u0438\u043D ",-1)),we=x({__name:"TheToolsRoles",setup(n){const t=G(),{fetchFunc:s,data:u,isLoading:_}=F({callback:async()=>R.getUsers(t.user._id),alert:!1}),{fetchFunc:l}=F({callback:V,successMessage:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E"}),p=$(""),a=K(()=>{var f;return(f=u.value)==null?void 0:f.filter(h=>h.email.toLowerCase().includes(p.value.toLowerCase())||h.name.toLowerCase().includes(p.value.toLowerCase()))});ee(s);async function V(f,h){return t.alert.isVisible&&t.showAlert(!1),R.updateRoles(f,h)}return(f,h)=>{const m=c("LoadingWheel"),C=c("v-text-field"),v=c("v-tooltip"),I=c("CCheckbox");return i(_)?(r(),b("div",be,[o(m),Ve])):(r(),b("div",Ce,[o(C,{label:"\u041F\u043E\u0438\u0441\u043A",modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=d=>p.value=d),variant:"outlined"},null,8,["modelValue"]),e("table",ye,[e("tbody",null,[Te,(r(!0),b(W,null,Q(i(a),d=>(r(),b("tr",Ee,[e("td",ke,[e("span",null,[T(k(d.name),1),o(v,{activator:"parent",location:"bottom"},{default:E(()=>[T(k(d.name),1)]),_:2},1024)])]),e("td",$e,[e("span",null,[T(k(d.email),1),o(v,{activator:"parent",location:"bottom"},{default:E(()=>[T(k(d.email),1)]),_:2},1024)])]),e("td",null,[e("div",De,[o(I,{class:"role_set",value:"user",modelValue:d.roles,"onUpdate:modelValue":y=>d.roles=y,disabled:!0,theme:i(t).currentTheme},null,8,["modelValue","onUpdate:modelValue","theme"]),xe]),e("div",Ie,[o(I,{class:"role_set",value:"admin",modelValue:d.roles,"onUpdate:modelValue":y=>d.roles=y,onChange:y=>i(l)(d._id,d.roles),theme:i(t).currentTheme},null,8,["modelValue","onUpdate:modelValue","onChange","theme"]),Ue])])]))),256))])])]))}}});const Se=B(we,[["__scopeId","data-v-1285b9d7"]]),Fe=n=>(P("data-v-af500cc2"),n=n(),M(),n),Be={class:"tools"},Le=Fe(()=>e("h1",{class:"title"},"\u0418\u043D\u0441\u0442\u0440\u0443\u043C\u0435\u043D\u0442\u044B",-1)),Ae={class:"tools_list"},Re={class:"list_item"},Ge={class:"list_item"},Ke={class:"list_item"},We=x({__name:"TheTools",setup(n){const{goBack:t}=te(),s=j({integrate:!1,sheets:!1,adminRights:!1});function u(_){Object.keys(s).forEach(l=>{const p=l;s[p]!==s[_]&&(s[p]=!1)}),s[_]=!s[_]}return(_,l)=>{const p=c("v-btn");return r(),b(W,null,[o(p,{class:"home_button",onClick:i(t)},{default:E(()=>[T("\u041D\u0430\u0437\u0430\u0434")]),_:1},8,["onClick"]),e("div",Be,[Le,e("ul",Ae,[e("li",Re,[e("h3",{class:A(["item_title",s.integrate?"selected":""]),onClick:l[0]||(l[0]=a=>u("integrate"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044E \u0441 Google",2),w(o(ae,null,null,512),[[S,s.integrate]])]),e("li",Ge,[e("h3",{class:A(["item_title",s.sheets?"selected":""]),onClick:l[1]||(l[1]=a=>u("sheets"))},"\u0412\u044B\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0438 \u0432 Google Sheets",2),w(o(ge,null,null,512),[[S,s.sheets]])]),e("li",Ke,[e("h3",{class:A(["item_title",s.adminRights?"selected":""]),onClick:l[2]||(l[2]=a=>u("adminRights"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0440\u043E\u043B\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439",2),s.adminRights?(r(),D(Se,{key:0})):U("",!0)])])])],64)}}});const Pe=B(We,[["__scopeId","data-v-af500cc2"]]),ut=x({__name:"ToolsView",setup(n){const t=G();return(s,u)=>i(t).isAdmin?(r(),D(Pe,{key:1})):(r(),D(q,{key:0,code:403,message:"Forbidden"}))}});export{ut as default};
