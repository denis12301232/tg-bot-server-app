import{d as D,I as j,v as R,z as I,j as p,a as c,c as g,e as l,b as t,w as E,f as y,u as _,m as $,L as G,h as U,t as k,J as W,_ as F,x as T,A as H,K as X,F as K,r as z,G as w,M as S,C as Y,p as M,k as P,l as q,y as Z,q as A}from"./index.e2799918.js";import ee from"./TheError.6740ba1e.js";import{T as L}from"./ToolsService.ca49341b.js";const te={class:"google_control"},se={class:"google_message"},ue=D({__name:"TheToolsGoogle",setup(a){const e=j({serviceUser:"",servicePrivateKey:"",sheetId:"",folderId:"",message:""}),s=R(()=>!e.serviceUser&&!e.servicePrivateKey&&!e.sheetId&&!e.folderId),{fetchFunc:n,isLoading:u}=I({callback:h,successMessage:"\u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E"});async function h(){await L.setGoogleServiceAccountSettings(e.serviceUser,e.servicePrivateKey,e.sheetId,e.folderId),e.serviceUser="",e.servicePrivateKey="",e.sheetId="",e.folderId=""}return(v,i)=>{const f=p("v-text-field"),b=p("v-btn");return c(),g("form",{class:"google",onSubmit:i[4]||(i[4]=W((...o)=>_(n)&&_(n)(...o),["prevent"]))},[l(f,{modelValue:e.serviceUser,"onUpdate:modelValue":i[0]||(i[0]=o=>e.serviceUser=o),variant:"outlined",label:"Service account email"},null,8,["modelValue"]),l(f,{modelValue:e.servicePrivateKey,"onUpdate:modelValue":i[1]||(i[1]=o=>e.servicePrivateKey=o),variant:"outlined",label:"Service account private key"},null,8,["modelValue"]),l(f,{modelValue:e.sheetId,"onUpdate:modelValue":i[2]||(i[2]=o=>e.sheetId=o),variant:"outlined",label:"Sheet ID"},null,8,["modelValue"]),l(f,{modelValue:e.folderId,"onUpdate:modelValue":i[3]||(i[3]=o=>e.folderId=o),variant:"outlined",label:"Folder ID"},null,8,["modelValue"]),t("div",te,[l(b,{type:"submit",disabled:_(s)},{default:E(()=>[y("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C")]),_:1},8,["disabled"]),_(u)?(c(),$(G,{key:0})):U("",!0),t("div",se,k(e.message),1)])],32)}}});const le=F(ue,[["__scopeId","data-v-343c3840"]]),N=a=>(M("data-v-f86014b1"),a=a(),P(),a),oe={class:"filter_container"},ae=N(()=>t("h3",{class:"filter_title"},"\u041A\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u0432\u044B\u0433\u0440\u0443\u0437\u043A\u0438",-1)),ne={class:"filter_content"},ie={class:"item_title"},de={class:"filter"},ce=N(()=>t("h4",{class:"filter_title"},"\u0420\u0430\u0439\u043E\u043D",-1)),re={class:"filter"},_e=N(()=>t("h4",{class:"filter_title"},"\u0413\u043E\u0434 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F",-1)),ve={class:"buttons"},me=["href"],pe=D({__name:"TheToolsSheets",setup(a){const e=T([]),s=T([1920,2022]),n=T(""),u=T(""),h=R(()=>e.value.length?e.value.includes("district")&&e.value.includes("birth")?f.value||!u.value||!s.value[0]||!s.value[1]:f.value||!u.value&&(!s.value[0]||!s.value[1]):!0),v=[{name:"\u041F\u043E \u0440\u0430\u0439\u043E\u043D\u0443",value:"district"},{name:"\u041F\u043E \u0433\u043E\u0434\u0443",value:"birth"}],{fetchFunc:i,isLoading:f,data:b}=I({callback:o,successMessage:"\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u043E"});async function o(){n.value="";const V={district:u.value,birth:{from:s.value[0],to:s.value[1]||9999}};return await H.saveFormsToSheet(V)}return X(b,()=>{var V;n.value=((V=b.value)==null?void 0:V.link)||""}),(V,r)=>{const x=p("CCheckbox"),d=p("v-select"),C=p("v-text-field"),J=p("v-range-slider"),O=p("v-btn");return c(),g("div",oe,[ae,t("div",ne,[(c(),g(K,null,z(v,m=>t("div",{class:"filter_item",key:m.name},[t("header",ie,k(m.name),1),l(x,{modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=Q=>e.value=Q),value:m.value},null,8,["modelValue","value"])])),64))]),w(t("div",de,[ce,l(d,{modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=m=>u.value=m),label:"\u0420\u0430\u0439\u043E\u043D",items:_(Y).districts},null,8,["modelValue","items"])],512),[[S,e.value.includes("district")]]),w(t("div",re,[_e,l(J,{min:"1920",max:"2022",step:"1",modelValue:s.value,"onUpdate:modelValue":r[4]||(r[4]=m=>s.value=m)},{prepend:E(()=>[l(C,{modelValue:s.value[0],"onUpdate:modelValue":r[2]||(r[2]=m=>s.value[0]=m),"hide-details":"","single-line":"",type:"number",variant:"outlined",density:"compact",style:{width:"85px"}},null,8,["modelValue"])]),append:E(()=>[l(C,{modelValue:s.value[1],"onUpdate:modelValue":r[3]||(r[3]=m=>s.value[1]=m),"hide-details":"","single-line":"",type:"number",variant:"outlined",style:{width:"85px"},density:"compact"},null,8,["modelValue"])]),_:1},8,["modelValue"])],512),[[S,e.value.includes("birth")]]),t("div",ve,[l(O,{onClick:_(i),disabled:_(h)},{default:E(()=>[y("\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1},8,["onClick","disabled"]),_(f)?(c(),$(G,{key:0})):U("",!0)]),n.value?(c(),g("a",{key:0,class:"sheets_link",target:"_blank",href:n.value},"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u0432\u044B\u0433\u0440\u0443\u0436\u0435\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438",8,me)):U("",!0)])}}});const he=F(pe,[["__scopeId","data-v-f86014b1"]]),B=a=>(M("data-v-230328e7"),a=a(),P(),a),fe={key:0,class:"loader"},be=B(()=>t("span",null,null,-1)),ge={key:1,class:"content"},Ve={class:"user_list"},Ce=B(()=>t("tr",{class:"list_header"},[t("th",null,"\u0418\u043C\u044F"),t("th",null,"\u0415-\u043C\u044D\u0439\u043B"),t("th",null,"\u0420\u043E\u043B\u044C")],-1)),ye={class:"list_row"},Ee={class:"row_item"},ke={class:"row_item"},Te={class:"roles"},$e=B(()=>t("label",{class:"role_name"},"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",-1)),De={class:"roles"},xe=B(()=>t("label",{class:"role_name"},"\u0410\u0434\u043C\u0438\u043D ",-1)),Ie=D({__name:"TheToolsRoles",setup(a){const e=q(),{fetchFunc:s,data:n,isLoading:u}=I({callback:async()=>L.getUsers(e.user._id),alert:!1}),{fetchFunc:h}=I({callback:f,successMessage:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E"}),v=T(""),i=R(()=>{var b;return(b=n.value)==null?void 0:b.filter(o=>o.email.toLowerCase().includes(v.value.toLowerCase())||o.name.toLowerCase().includes(v.value.toLowerCase()))});Z(s);async function f(b,o){return e.alert.isVisible&&e.showAlert(!1),L.updateRoles(b,o)}return(b,o)=>{const V=p("v-text-field"),r=p("v-tooltip"),x=p("CCheckbox");return _(u)?(c(),g("div",fe,[l(G),be])):(c(),g("div",ge,[l(V,{label:"\u041F\u043E\u0438\u0441\u043A",modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=d=>v.value=d),variant:"outlined"},null,8,["modelValue"]),t("table",Ve,[t("tbody",null,[Ce,(c(!0),g(K,null,z(_(i),d=>(c(),g("tr",ye,[t("td",Ee,[t("span",null,[y(k(d.name),1),l(r,{activator:"parent",location:"bottom"},{default:E(()=>[y(k(d.name),1)]),_:2},1024)])]),t("td",ke,[t("span",null,[y(k(d.email),1),l(r,{activator:"parent",location:"bottom"},{default:E(()=>[y(k(d.email),1)]),_:2},1024)])]),t("td",null,[t("div",Te,[l(x,{class:"role_set",value:"user",modelValue:d.roles,"onUpdate:modelValue":C=>d.roles=C,disabled:!0},null,8,["modelValue","onUpdate:modelValue"]),$e]),t("div",De,[l(x,{class:"role_set",value:"admin",modelValue:d.roles,"onUpdate:modelValue":C=>d.roles=C,onChange:C=>_(h)(d._id,d.roles)},null,8,["modelValue","onUpdate:modelValue","onChange"]),xe])])]))),256))])])]))}}});const Ue=F(Ie,[["__scopeId","data-v-230328e7"]]),we=a=>(M("data-v-8b5eab56"),a=a(),P(),a),Se={class:"tools"},Fe=we(()=>t("h1",{class:"title"},"\u0418\u043D\u0441\u0442\u0440\u0443\u043C\u0435\u043D\u0442\u044B",-1)),Be={class:"tools_list"},Ae={class:"list_item"},Le={class:"list_item"},Re={class:"list_item"},Ge=D({__name:"TheTools",setup(a){const e=j({integrate:!1,sheets:!1,adminRights:!1});function s(n){Object.keys(e).forEach(u=>{const h=u;e[h]!==e[n]&&(e[h]=!1)}),e[n]=!e[n]}return(n,u)=>{const h=p("v-btn");return c(),g(K,null,[l(h,{class:"home_button",onClick:u[0]||(u[0]=v=>n.$router.push("/"))},{default:E(()=>[y("\u041D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E")]),_:1}),t("div",Se,[Fe,t("ul",Be,[t("li",Ae,[t("h3",{class:A(["item_title",e.integrate?"selected":""]),onClick:u[1]||(u[1]=v=>s("integrate"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044E \u0441 Google",2),w(l(le,null,null,512),[[S,e.integrate]])]),t("li",Le,[t("h3",{class:A(["item_title",e.sheets?"selected":""]),onClick:u[2]||(u[2]=v=>s("sheets"))},"\u0412\u044B\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0438 \u0432 Google Sheets",2),w(l(he,null,null,512),[[S,e.sheets]])]),t("li",Re,[t("h3",{class:A(["item_title",e.adminRights?"selected":""]),onClick:u[3]||(u[3]=v=>s("adminRights"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0440\u043E\u043B\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439",2),e.adminRights?(c(),$(Ue,{key:0})):U("",!0)])])])],64)}}});const Ke=F(Ge,[["__scopeId","data-v-8b5eab56"]]),je=D({__name:"ToolsView",setup(a){const e=q();return(s,n)=>_(e).isAdmin?(c(),$(Ke,{key:1})):(c(),$(ee,{key:0,code:403,message:"Forbidden"}))}});export{je as default};
