import{u as T,U as Y,_ as tt}from"./index.2d61b0ad.js";import{T as et,a as st}from"./TheHeaderMenu.3e1e45ce.js";import{j as B,h as x,r as C,E as ot,W as r,U as p,y as s,_ as a,X as l,u as e,Q as m,a5 as g,V as v,F as H,a4 as it,Z as A,a9 as nt,ab as at,T as lt,I as ut,$ as c,J as ct,a7 as rt,a8 as dt}from"./@vue.6acdfb34.js";import{u as _t}from"./vue-router.cd563335.js";import{d as mt}from"./pinia.6b015bcc.js";import{u as E}from"./useFetching.28e2ee03.js";import{A as F}from"./AssistanceService.be5eaf50.js";import pt from"./TheError.8d836bc1.js";import"./vuetify.e3688c29.js";import"./axios.0e4a87d2.js";import"./form-data.2b153385.js";/* empty css             */import"./core-js.40dbafa1.js";import"./vue-demi.b3a9cad9.js";import"./useForm.12d3d566.js";const ht=mt("human",{state:()=>({list:{page:0,total:0,limit:20,isLoading:!1,humansList:[],selectedSort:null,searchQuery:""}}),getters:{sortedHumansList(i){return typeof i.list.selectedSort=="string"?[...i.list.humansList].sort((o,h)=>{var t;return(t=o[i.list.selectedSort])==null?void 0:t.localeCompare(h[i.list.selectedSort])}):i.list.humansList},sortedAndSearchedHumansList(){return[...this.sortedHumansList].filter(i=>i.fio.includes(this.list.searchQuery))}}}),D=i=>(rt("data-v-4f3ca15b"),i=i(),dt(),i),ft=D(()=>l("h2",{style:{"text-align":"center"}},"\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?",-1)),vt={class:"buttons"},gt={class:"buttons_load"},bt={class:"buttons_load"},yt={class:"container"},Lt=D(()=>l("h1",{class:"title",style:{"margin-bottom":"10px"}},"\u041F\u043E\u043B\u043D\u044B\u0439 \u0441\u043F\u0438\u0441\u043E\u043A",-1)),kt={style:{padding:"5px 0"}},Ct={class:"list_number",style:{padding:"0 10px"}},Ht={class:"list_buttons"},St={key:0,class:"error_message"},wt={key:1,class:"loading"},Vt={class:"observer"},xt=B({__name:"HumansList",setup(i){const o=T(),h=_t(),t=ht(),M=x(()=>t.list.page<t.list.total&&!L.value),$=x(()=>!t.list.humansList.length),b=C(!1),y=C(""),I=C([{value:"_id",title:"\u041F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E"},{value:"fio",title:"\u041F\u043E \u0444\u0430\u043C\u0438\u043B\u0438\u0438"}]);ot(()=>{t.list.humansList.length||S()});const{fetchFunc:S,isLoading:L}=E({callback:W,alert:!1}),{fetchFunc:Q,isLoading:U}=E({callback:N,successMessage:"\u0423\u0434\u0430\u043B\u0435\u043D\u043E"});async function W(){t.list.page++;const n=await F.catchHumansList({limit:t.list.limit,page:t.list.page});t.list.total=Math.ceil(+n.headers["x-total-count"]/t.list.limit),t.list.humansList=[...t.list.humansList,...n.data.humansList]}async function N(){o.alert.isVisible&&o.showAlert(!1),await F.deleteHuman(y.value),f(),t.list.humansList=t.list.humansList.filter(n=>n._id!==y.value)}function f(n){b.value=!b.value,n&&(y.value=n)}async function P(n){try{o.alert.isVisible&&o.showAlert(!1);const d=await Y.copyToClipboard(n);o.setAlert("success",d)}catch(d){o.setAlert("error",d)}finally{o.showAlert(!0)}}function R(n){h.push({path:"/info",query:{search:n}})}return(n,d)=>{const w=c("v-btn"),V=c("LoadingWheel"),j=c("ModalWindow"),q=c("v-select"),z=c("v-text-field"),k=c("v-icon"),G=c("v-tooltip"),J=c("v-list-item-title"),O=c("v-list-item"),X=c("v-list"),Z=ct("intersection");return r(),p(H,null,[s(j,{show:b.value,onHide:f,theme:e(o).currentTheme},{default:a(()=>[ft,l("div",vt,[l("div",gt,[s(w,{class:"confirm",onClick:e(Q)},{default:a(()=>[m("\u0414\u0430")]),_:1},8,["onClick"]),e(U)?(r(),g(V,{key:0,class:"wheel"})):v("",!0)]),l("div",bt,[s(w,{class:"confirm",onClick:f},{default:a(()=>[m("\u041D\u0435\u0442")]),_:1})])])]),_:1},8,["show","theme"]),l("div",yt,[Lt,l("div",kt,[s(q,{label:"\u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",items:I.value,modelValue:e(t).list.selectedSort,"onUpdate:modelValue":d[0]||(d[0]=u=>e(t).list.selectedSort=u),variant:"solo"},null,8,["items","modelValue"]),s(z,{label:"\u041F\u043E\u0438\u0441\u043A",modelValue:e(t).list.searchQuery,"onUpdate:modelValue":d[1]||(d[1]=u=>e(t).list.searchQuery=u),variant:"solo"},null,8,["modelValue"])]),e(t).sortedAndSearchedHumansList.length?(r(),g(X,{key:0,class:"list"},{default:a(()=>[s(lt,{name:"list"},{default:a(()=>[(r(!0),p(H,null,it(e(t).sortedAndSearchedHumansList,(u,K)=>(r(),g(O,{class:"list_item",key:u._id},{prepend:a(()=>[l("div",Ct,A(K+1+"."),1)]),append:a(()=>[l("div",Ht,[s(k,{class:"item_button",tag:"button",onClick:_=>P(u.fio)},{default:a(()=>[m("mdi-content-copy")]),_:2},1032,["onClick"]),s(k,{class:"item_button",tag:"button",onClick:_=>R(u.fio)},{default:a(()=>[m("mdi-magnify")]),_:2},1032,["onClick"]),s(k,{class:"item_button",tag:"button",onClick:_=>f(u._id)},{default:a(()=>[m("mdi-delete-forever")]),_:2},1032,["onClick"])])]),default:a(()=>[s(J,{class:"list_title",onClick:_=>n.$router.push(`/list/${u._id}`)},{default:a(()=>[s(G,{text:u.fio,location:"bottom"},{activator:a(({props:_})=>[l("span",nt(at(_)),A(u.fio),17)]),_:2},1032,["text"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})):v("",!0)]),e($)&&!e(L)?(r(),p("h3",St,"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0443\u0441\u0442")):v("",!0),e(L)?(r(),p("div",wt,[s(V)])):v("",!0),l("div",Vt,[ut(l("div",null,null,512),[[Z,{f:e(S),canLoad:()=>e(M)}]])])],64)}}});const At=tt(xt,[["__scopeId","data-v-4f3ca15b"]]),Et={class:"content"},zt=B({__name:"ListView",setup(i){const o=T();return(h,t)=>e(o).isAdmin?(r(),p(H,{key:1},[s(et,{onShow:e(o).setMenuVisible,onTheme:e(o).setTheme},null,8,["onShow","onTheme"]),s(st),l("div",Et,[s(At)])],64)):(r(),g(pt,{key:0,code:403,message:"Forbidden"}))}});export{zt as default};
