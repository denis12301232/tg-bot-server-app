import{_ as F,u as K,C as q}from"./index.552cec41.js";import H from"./TheError.7fe7e486.js";import{j as x,a as z,h as W,$ as r,W as _,U as V,y as o,X as e,_ as k,Q as y,u as i,a5 as D,V as I,Z as E,a2 as J,r as $,w as ee,F as P,a4 as O,I as U,K as w,a7 as M,a8 as N,E as te,Y as R}from"./@vue.6acdfb34.js";import{u as se}from"./useNavigation.8e3f35ed.js";import{u as S}from"./useFetching.572bd5af.js";import{T as G}from"./ToolsService.7132b3bd.js";import{A as ue}from"./AssistanceService.0e5e3e8e.js";import"./pinia.6b015bcc.js";import"./vue-demi.b3a9cad9.js";import"./vuetify.e3688c29.js";import"./axios.0e4a87d2.js";import"./form-data.2b153385.js";import"./vue-router.cd563335.js";/* empty css             */import"./core-js.40dbafa1.js";const oe={class:"google_control"},le={class:"google_message"},ae=x({__name:"TheToolsGoogle",setup(n){const t=z({serviceUser:"",servicePrivateKey:"",sheetId:"",folderId:"",message:""}),s=W(()=>!t.serviceUser&&!t.servicePrivateKey&&!t.sheetId&&!t.folderId),{fetchFunc:u,isLoading:m}=S({callback:l,successMessage:"\u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E"});async function l(){await G.setGoogleServiceAccountSettings(t.serviceUser,t.servicePrivateKey,t.sheetId,t.folderId),t.serviceUser="",t.servicePrivateKey="",t.sheetId="",t.folderId=""}return(h,a)=>{const C=r("v-text-field"),b=r("v-btn"),p=r("LoadingWheel");return _(),V("form",{class:"google",onSubmit:a[4]||(a[4]=J((...v)=>i(u)&&i(u)(...v),["prevent"]))},[o(C,{modelValue:t.serviceUser,"onUpdate:modelValue":a[0]||(a[0]=v=>t.serviceUser=v),variant:"outlined",label:"Service account email"},null,8,["modelValue"]),o(C,{modelValue:t.servicePrivateKey,"onUpdate:modelValue":a[1]||(a[1]=v=>t.servicePrivateKey=v),variant:"outlined",label:"Service account private key"},null,8,["modelValue"]),o(C,{modelValue:t.sheetId,"onUpdate:modelValue":a[2]||(a[2]=v=>t.sheetId=v),variant:"outlined",label:"Sheet ID"},null,8,["modelValue"]),o(C,{modelValue:t.folderId,"onUpdate:modelValue":a[3]||(a[3]=v=>t.folderId=v),variant:"outlined",label:"Folder ID"},null,8,["modelValue"]),e("div",oe,[o(b,{type:"submit",disabled:i(s)},{default:k(()=>[y("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C")]),_:1},8,["disabled"]),i(m)?(_(),D(p,{key:0})):I("",!0),e("div",le,E(t.message),1)])],32)}}});const ne=F(ae,[["__scopeId","data-v-6b80d342"]]),j=n=>(M("data-v-bc947ab1"),n=n(),N(),n),ie={class:"filter_container"},de=j(()=>e("h3",{class:"filter_title"},"\u041A\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u0432\u044B\u0433\u0440\u0443\u0437\u043A\u0438",-1)),ce={class:"filter_content"},re={class:"item_title"},_e={class:"filter"},me=j(()=>e("h4",{class:"filter_title"},"\u0420\u0430\u0439\u043E\u043D",-1)),ve={class:"filter"},he=j(()=>e("h4",{class:"filter_title"},"\u0413\u043E\u0434 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F",-1)),pe={class:"buttons"},fe=["href"],be=x({__name:"TheToolsSheets",setup(n){const t=K(),s=$([]),u=$([1920,2022]),m=$(""),l=$(null),h=W(()=>s.value.length?s.value.includes("district")&&s.value.includes("birth")?b.value||!l.value||!u.value[0]||!u.value[1]:b.value||!l.value&&(!u.value[0]||!u.value[1]):!0),a=[{name:"\u041F\u043E \u0440\u0430\u0439\u043E\u043D\u0443",value:"district"},{name:"\u041F\u043E \u0433\u043E\u0434\u0443",value:"birth"}],{fetchFunc:C,isLoading:b,data:p}=S({callback:v,successMessage:"\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u043E"});async function v(){m.value="";const g={district:l.value,birth:{from:u.value[0],to:u.value[1]||9999}};return await ue.saveFormsToSheet(g)}ee(p,()=>{var g;m.value=((g=p.value)==null?void 0:g.link)||""});function L(g,d){if(!g)switch(d){case"district":l.value=null;return;case"birth":u.value=[1920,2022];return}}return(g,d)=>{const c=r("CCheckbox"),T=r("v-select"),Q=r("v-text-field"),X=r("v-range-slider"),Y=r("v-btn"),Z=r("LoadingWheel");return _(),V("div",ie,[de,e("div",ce,[(_(),V(P,null,O(a,f=>e("div",{class:"filter_item",key:f.name},[e("header",re,E(f.name),1),o(c,{modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=A=>s.value=A),value:f.value,theme:i(t).currentTheme,onChecked:A=>L(A,f.value)},null,8,["modelValue","value","theme","onChecked"])])),64))]),U(e("div",_e,[me,o(T,{modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=f=>l.value=f),label:"\u0420\u0430\u0439\u043E\u043D",items:i(q).districts},null,8,["modelValue","items"])],512),[[w,s.value.includes("district")]]),U(e("div",ve,[he,o(X,{min:"1920",max:"2022",step:"1",modelValue:u.value,"onUpdate:modelValue":d[4]||(d[4]=f=>u.value=f)},{prepend:k(()=>[o(Q,{modelValue:u.value[0],"onUpdate:modelValue":d[2]||(d[2]=f=>u.value[0]=f),"hide-details":"","single-line":"",type:"number",variant:"outlined",density:"compact",style:{width:"85px"}},null,8,["modelValue"])]),append:k(()=>[o(Q,{modelValue:u.value[1],"onUpdate:modelValue":d[3]||(d[3]=f=>u.value[1]=f),"hide-details":"","single-line":"",type:"number",variant:"outlined",style:{width:"85px"},density:"compact"},null,8,["modelValue"])]),_:1},8,["modelValue"])],512),[[w,s.value.includes("birth")]]),e("div",pe,[o(Y,{onClick:i(C),disabled:i(h)},{default:k(()=>[y("\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1},8,["onClick","disabled"]),i(b)?(_(),D(Z,{key:0})):I("",!0)]),m.value?(_(),V("a",{key:0,class:"sheets_link",target:"_blank",href:m.value},"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u0432\u044B\u0433\u0440\u0443\u0436\u0435\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438",8,fe)):I("",!0)])}}});const ge=F(be,[["__scopeId","data-v-bc947ab1"]]),B=n=>(M("data-v-1285b9d7"),n=n(),N(),n),Ve={key:0,class:"loader"},Ce=B(()=>e("span",null,null,-1)),ye={key:1,class:"content"},ke={class:"user_list"},Te=B(()=>e("tr",{class:"list_header"},[e("th",null,"\u0418\u043C\u044F"),e("th",null,"\u0415-\u043C\u044D\u0439\u043B"),e("th",null,"\u0420\u043E\u043B\u044C")],-1)),Ee={class:"list_row"},$e={class:"row_item"},De={class:"row_item"},xe={class:"roles"},Ie=B(()=>e("label",{class:"role_name"},"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",-1)),Ue={class:"roles"},we=B(()=>e("label",{class:"role_name"},"\u0410\u0434\u043C\u0438\u043D ",-1)),Se=x({__name:"TheToolsRoles",setup(n){const t=K(),{fetchFunc:s,data:u,isLoading:m}=S({callback:async()=>G.getUsers(t.user._id),alert:!1}),{fetchFunc:l}=S({callback:C,successMessage:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E"}),h=$(""),a=W(()=>{var b;return(b=u.value)==null?void 0:b.filter(p=>p.email.toLowerCase().includes(h.value.toLowerCase())||p.name.toLowerCase().includes(h.value.toLowerCase()))});te(s);async function C(b,p){return t.alert.isVisible&&t.showAlert(!1),G.updateRoles(b,p)}return(b,p)=>{const v=r("LoadingWheel"),L=r("v-text-field"),g=r("v-tooltip"),d=r("CCheckbox");return i(m)?(_(),V("div",Ve,[o(v),Ce])):(_(),V("div",ye,[o(L,{label:"\u041F\u043E\u0438\u0441\u043A",modelValue:h.value,"onUpdate:modelValue":p[0]||(p[0]=c=>h.value=c),variant:"outlined"},null,8,["modelValue"]),e("table",ke,[e("tbody",null,[Te,(_(!0),V(P,null,O(i(a),c=>(_(),V("tr",Ee,[e("td",$e,[e("span",null,[y(E(c.name),1),o(g,{activator:"parent",location:"bottom"},{default:k(()=>[y(E(c.name),1)]),_:2},1024)])]),e("td",De,[e("span",null,[y(E(c.email),1),o(g,{activator:"parent",location:"bottom"},{default:k(()=>[y(E(c.email),1)]),_:2},1024)])]),e("td",null,[e("div",xe,[o(d,{class:"role_set",value:"user",modelValue:c.roles,"onUpdate:modelValue":T=>c.roles=T,disabled:!0,theme:i(t).currentTheme},null,8,["modelValue","onUpdate:modelValue","theme"]),Ie]),e("div",Ue,[o(d,{class:"role_set",value:"admin",modelValue:c.roles,"onUpdate:modelValue":T=>c.roles=T,onChange:T=>i(l)(c._id,c.roles),theme:i(t).currentTheme},null,8,["modelValue","onUpdate:modelValue","onChange","theme"]),we])])]))),256))])])]))}}});const Fe=F(Se,[["__scopeId","data-v-1285b9d7"]]),Be=n=>(M("data-v-af500cc2"),n=n(),N(),n),Le={class:"tools"},Ae=Be(()=>e("h1",{class:"title"},"\u0418\u043D\u0441\u0442\u0440\u0443\u043C\u0435\u043D\u0442\u044B",-1)),Re={class:"tools_list"},Ge={class:"list_item"},Ke={class:"list_item"},We={class:"list_item"},Pe=x({__name:"TheTools",setup(n){const{goBack:t}=se(),s=z({integrate:!1,sheets:!1,adminRights:!1});function u(m){Object.keys(s).forEach(l=>{const h=l;s[h]!==s[m]&&(s[h]=!1)}),s[m]=!s[m]}return(m,l)=>{const h=r("v-btn");return _(),V(P,null,[o(h,{class:"home_button",onClick:i(t)},{default:k(()=>[y("\u041D\u0430\u0437\u0430\u0434")]),_:1},8,["onClick"]),e("div",Le,[Ae,e("ul",Re,[e("li",Ge,[e("h3",{class:R(["item_title",s.integrate?"selected":""]),onClick:l[0]||(l[0]=a=>u("integrate"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044E \u0441 Google",2),U(o(ne,null,null,512),[[w,s.integrate]])]),e("li",Ke,[e("h3",{class:R(["item_title",s.sheets?"selected":""]),onClick:l[1]||(l[1]=a=>u("sheets"))},"\u0412\u044B\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0438 \u0432 Google Sheets",2),U(o(ge,null,null,512),[[w,s.sheets]])]),e("li",We,[e("h3",{class:R(["item_title",s.adminRights?"selected":""]),onClick:l[2]||(l[2]=a=>u("adminRights"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0440\u043E\u043B\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439",2),s.adminRights?(_(),D(Fe,{key:0})):I("",!0)])])])],64)}}});const Me=F(Pe,[["__scopeId","data-v-af500cc2"]]),ot=x({__name:"ToolsView",setup(n){const t=K();return(s,u)=>i(t).isAdmin?(_(),D(Me,{key:1})):(_(),D(H,{key:0,code:403,message:"Forbidden"}))}});export{ot as default};
