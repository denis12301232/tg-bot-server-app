import{d as x,k as j,m as G,r as c,o as r,c as b,e as l,g as e,w as k,h as T,b as i,n as D,f as U,z as E,p as J,_ as F,u as P,j as $,l as X,F as K,I as z,N as w,P as S,C as Y,q as N,s as W,E as Z,B as A}from"./index.800cd8c5.js";import ee from"./TheError.e1a46428.js";import{u as te}from"./useNavigation.09a04393.js";import{u as B}from"./useFetching.eee5a6d9.js";import{T as R}from"./ToolsService.d1aa185d.js";import{A as se}from"./AssistanceService.c1eb7ba1.js";const ue={class:"google_control"},le={class:"google_message"},oe=x({__name:"TheToolsGoogle",setup(n){const t=j({serviceUser:"",servicePrivateKey:"",sheetId:"",folderId:"",message:""}),s=G(()=>!t.serviceUser&&!t.servicePrivateKey&&!t.sheetId&&!t.folderId),{fetchFunc:u,isLoading:_}=B({callback:o,successMessage:"\u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E"});async function o(){await R.setGoogleServiceAccountSettings(t.serviceUser,t.servicePrivateKey,t.sheetId,t.folderId),t.serviceUser="",t.servicePrivateKey="",t.sheetId="",t.folderId=""}return(h,a)=>{const V=c("v-text-field"),f=c("v-btn"),p=c("LoadingWheel");return r(),b("form",{class:"google",onSubmit:a[4]||(a[4]=J((...m)=>i(u)&&i(u)(...m),["prevent"]))},[l(V,{modelValue:t.serviceUser,"onUpdate:modelValue":a[0]||(a[0]=m=>t.serviceUser=m),variant:"outlined",label:"Service account email"},null,8,["modelValue"]),l(V,{modelValue:t.servicePrivateKey,"onUpdate:modelValue":a[1]||(a[1]=m=>t.servicePrivateKey=m),variant:"outlined",label:"Service account private key"},null,8,["modelValue"]),l(V,{modelValue:t.sheetId,"onUpdate:modelValue":a[2]||(a[2]=m=>t.sheetId=m),variant:"outlined",label:"Sheet ID"},null,8,["modelValue"]),l(V,{modelValue:t.folderId,"onUpdate:modelValue":a[3]||(a[3]=m=>t.folderId=m),variant:"outlined",label:"Folder ID"},null,8,["modelValue"]),e("div",ue,[l(f,{type:"submit",disabled:i(s)},{default:k(()=>[T("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C")]),_:1},8,["disabled"]),i(_)?(r(),D(p,{key:0})):U("",!0),e("div",le,E(t.message),1)])],32)}}});const ae=F(oe,[["__scopeId","data-v-6b80d342"]]),M=n=>(N("data-v-d439015b"),n=n(),W(),n),ne={class:"filter_container"},ie=M(()=>e("h3",{class:"filter_title"},"\u041A\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u0432\u044B\u0433\u0440\u0443\u0437\u043A\u0438",-1)),de={class:"filter_content"},ce={class:"item_title"},re={class:"filter"},_e=M(()=>e("h4",{class:"filter_title"},"\u0420\u0430\u0439\u043E\u043D",-1)),me={class:"filter"},ve=M(()=>e("h4",{class:"filter_title"},"\u0413\u043E\u0434 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F",-1)),he={class:"buttons"},pe=["href"],fe=x({__name:"TheToolsSheets",setup(n){const t=P(),s=$([]),u=$([1920,2022]),_=$(""),o=$(null),h=G(()=>s.value.length?s.value.includes("district")&&s.value.includes("birth")?f.value||!o.value||!u.value[0]||!u.value[1]:f.value||!o.value&&(!u.value[0]||!u.value[1]):!0),a=[{name:"\u041F\u043E \u0440\u0430\u0439\u043E\u043D\u0443",value:"district"},{name:"\u041F\u043E \u0433\u043E\u0434\u0443",value:"birth"}],{fetchFunc:V,isLoading:f,data:p}=B({callback:m,successMessage:"\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u043E"});async function m(){_.value="";const C={district:o.value,birth:{from:u.value[0],to:u.value[1]||9999}};return await se.saveFormsToSheet(C)}return X(p,()=>{var C;_.value=((C=p.value)==null?void 0:C.link)||""}),(C,v)=>{const I=c("CCheckbox"),d=c("v-select"),y=c("v-text-field"),q=c("v-range-slider"),O=c("v-btn"),Q=c("LoadingWheel");return r(),b("div",ne,[ie,e("div",de,[(r(),b(K,null,z(a,g=>e("div",{class:"filter_item",key:g.name},[e("header",ce,E(g.name),1),l(I,{modelValue:s.value,"onUpdate:modelValue":v[0]||(v[0]=H=>s.value=H),value:g.value,theme:i(t).currentTheme},null,8,["modelValue","value","theme"])])),64))]),w(e("div",re,[_e,l(d,{modelValue:o.value,"onUpdate:modelValue":v[1]||(v[1]=g=>o.value=g),label:"\u0420\u0430\u0439\u043E\u043D",items:i(Y).districts},null,8,["modelValue","items"])],512),[[S,s.value.includes("district")]]),w(e("div",me,[ve,l(q,{min:"1920",max:"2022",step:"1",modelValue:u.value,"onUpdate:modelValue":v[4]||(v[4]=g=>u.value=g)},{prepend:k(()=>[l(y,{modelValue:u.value[0],"onUpdate:modelValue":v[2]||(v[2]=g=>u.value[0]=g),"hide-details":"","single-line":"",type:"number",variant:"outlined",density:"compact",style:{width:"85px"}},null,8,["modelValue"])]),append:k(()=>[l(y,{modelValue:u.value[1],"onUpdate:modelValue":v[3]||(v[3]=g=>u.value[1]=g),"hide-details":"","single-line":"",type:"number",variant:"outlined",style:{width:"85px"},density:"compact"},null,8,["modelValue"])]),_:1},8,["modelValue"])],512),[[S,s.value.includes("birth")]]),e("div",he,[l(O,{onClick:i(V),disabled:i(h)},{default:k(()=>[T("\u0421\u0444\u043E\u0440\u043C\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1},8,["onClick","disabled"]),i(f)?(r(),D(Q,{key:0})):U("",!0)]),_.value?(r(),b("a",{key:0,class:"sheets_link",target:"_blank",href:_.value},"\u0421\u0441\u044B\u043B\u043A\u0430 \u043D\u0430 \u0432\u044B\u0433\u0440\u0443\u0436\u0435\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438",8,pe)):U("",!0)])}}});const ge=F(fe,[["__scopeId","data-v-d439015b"]]),L=n=>(N("data-v-1285b9d7"),n=n(),W(),n),be={key:0,class:"loader"},Ve=L(()=>e("span",null,null,-1)),Ce={key:1,class:"content"},ye={class:"user_list"},Te=L(()=>e("tr",{class:"list_header"},[e("th",null,"\u0418\u043C\u044F"),e("th",null,"\u0415-\u043C\u044D\u0439\u043B"),e("th",null,"\u0420\u043E\u043B\u044C")],-1)),ke={class:"list_row"},Ee={class:"row_item"},$e={class:"row_item"},De={class:"roles"},xe=L(()=>e("label",{class:"role_name"},"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",-1)),Ie={class:"roles"},Ue=L(()=>e("label",{class:"role_name"},"\u0410\u0434\u043C\u0438\u043D ",-1)),we=x({__name:"TheToolsRoles",setup(n){const t=P(),{fetchFunc:s,data:u,isLoading:_}=B({callback:async()=>R.getUsers(t.user._id),alert:!1}),{fetchFunc:o}=B({callback:V,successMessage:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E"}),h=$(""),a=G(()=>{var f;return(f=u.value)==null?void 0:f.filter(p=>p.email.toLowerCase().includes(h.value.toLowerCase())||p.name.toLowerCase().includes(h.value.toLowerCase()))});Z(s);async function V(f,p){return t.alert.isVisible&&t.showAlert(!1),R.updateRoles(f,p)}return(f,p)=>{const m=c("LoadingWheel"),C=c("v-text-field"),v=c("v-tooltip"),I=c("CCheckbox");return i(_)?(r(),b("div",be,[l(m),Ve])):(r(),b("div",Ce,[l(C,{label:"\u041F\u043E\u0438\u0441\u043A",modelValue:h.value,"onUpdate:modelValue":p[0]||(p[0]=d=>h.value=d),variant:"outlined"},null,8,["modelValue"]),e("table",ye,[e("tbody",null,[Te,(r(!0),b(K,null,z(i(a),d=>(r(),b("tr",ke,[e("td",Ee,[e("span",null,[T(E(d.name),1),l(v,{activator:"parent",location:"bottom"},{default:k(()=>[T(E(d.name),1)]),_:2},1024)])]),e("td",$e,[e("span",null,[T(E(d.email),1),l(v,{activator:"parent",location:"bottom"},{default:k(()=>[T(E(d.email),1)]),_:2},1024)])]),e("td",null,[e("div",De,[l(I,{class:"role_set",value:"user",modelValue:d.roles,"onUpdate:modelValue":y=>d.roles=y,disabled:!0,theme:i(t).currentTheme},null,8,["modelValue","onUpdate:modelValue","theme"]),xe]),e("div",Ie,[l(I,{class:"role_set",value:"admin",modelValue:d.roles,"onUpdate:modelValue":y=>d.roles=y,onChange:y=>i(o)(d._id,d.roles),theme:i(t).currentTheme},null,8,["modelValue","onUpdate:modelValue","onChange","theme"]),Ue])])]))),256))])])]))}}});const Se=F(we,[["__scopeId","data-v-1285b9d7"]]),Be=n=>(N("data-v-af500cc2"),n=n(),W(),n),Fe={class:"tools"},Le=Be(()=>e("h1",{class:"title"},"\u0418\u043D\u0441\u0442\u0440\u0443\u043C\u0435\u043D\u0442\u044B",-1)),Ae={class:"tools_list"},Re={class:"list_item"},Ge={class:"list_item"},Pe={class:"list_item"},Ke=x({__name:"TheTools",setup(n){const{goBack:t}=te(),s=j({integrate:!1,sheets:!1,adminRights:!1});function u(_){Object.keys(s).forEach(o=>{const h=o;s[h]!==s[_]&&(s[h]=!1)}),s[_]=!s[_]}return(_,o)=>{const h=c("v-btn");return r(),b(K,null,[l(h,{class:"home_button",onClick:i(t)},{default:k(()=>[T("\u041D\u0430\u0437\u0430\u0434")]),_:1},8,["onClick"]),e("div",Fe,[Le,e("ul",Ae,[e("li",Re,[e("h3",{class:A(["item_title",s.integrate?"selected":""]),onClick:o[0]||(o[0]=a=>u("integrate"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044E \u0441 Google",2),w(l(ae,null,null,512),[[S,s.integrate]])]),e("li",Ge,[e("h3",{class:A(["item_title",s.sheets?"selected":""]),onClick:o[1]||(o[1]=a=>u("sheets"))},"\u0412\u044B\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0438 \u0432 Google Sheets",2),w(l(ge,null,null,512),[[S,s.sheets]])]),e("li",Pe,[e("h3",{class:A(["item_title",s.adminRights?"selected":""]),onClick:o[2]||(o[2]=a=>u("adminRights"))},"\u041D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u044C \u0440\u043E\u043B\u0438 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439",2),s.adminRights?(r(),D(Se,{key:0})):U("",!0)])])])],64)}}});const Ne=F(Ke,[["__scopeId","data-v-af500cc2"]]),Qe=x({__name:"ToolsView",setup(n){const t=P();return(s,u)=>i(t).isAdmin?(r(),D(Ne,{key:1})):(r(),D(ee,{key:0,code:403,message:"Forbidden"}))}});export{Qe as default};
