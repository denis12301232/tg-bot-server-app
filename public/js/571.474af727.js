"use strict";(self["webpackChunktg_bot_client_app"]=self["webpackChunktg_bot_client_app"]||[]).push([[571,163],{9879:function(e,r,t){var s=t(655),i=t(100),n=function(){function e(){}return Object.defineProperty(e,"setNewName",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(r){return[2,i.Z.patch("/tools/name",{name:e})]}))}))}}),Object.defineProperty(e,"setNewEmail",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(r){return[2,i.Z.patch("/tools/email",{email:e})]}))}))}}),Object.defineProperty(e,"setNewPassword",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(t){return[2,i.Z.patch("/tools/password",{newPassword:e,oldPassword:r})]}))}))}}),Object.defineProperty(e,"setGoogleServiceAccountSettings",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r,t){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(s){return[2,i.Z.post("/tools/google/service",{serviceUser:e,servicePrivateKey:r,sheetId:t})]}))}))}}),e}();r["Z"]=n},4163:function(e,r,t){t.r(r),t.d(r,{default:function(){return m}});var s=t(6252),i=t(3577),n=(0,s.Uk)("На главную");function o(e,r,t,o,u,l){var a=(0,s.up)("v-button");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(e.$style.error)},[(0,s._)("div",{class:(0,i.C_)(e.$style.error_info)},[(0,s._)("div",{class:(0,i.C_)(e.$style.error_code)},(0,i.zw)(t.code),3),(0,s._)("div",{class:(0,i.C_)(e.$style.error_text)},(0,i.zw)(t.message),3),(0,s.Wm)(a,{class:(0,i.C_)(e.$style.error_button),onClick:r[0]||(r[0]=function(r){return e.$router.push("/")})},{default:(0,s.w5)((function(){return[n]})),_:1},8,["class"])],2)],2)}var u=(0,s.aZ)({__name:"TheError",props:{code:{type:[String,Number],required:!0},message:{type:String,required:!0}},setup:function(e,r){var t=r.expose;t();var s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),l={error:"TheError_error_zWRpU",error_info:"TheError_error_info_bRaoI",error_code:"TheError_error_code_p9lzC",error_text:"TheError_error_text_fLubd",error_button:"TheError_error_button_wjtdJ"},a=t(3744);const c={};c["$style"]=l;const d=(0,a.Z)(u,[["render",o],["__cssModules",c]]);var m=d},3571:function(e,r,t){t.r(r),t.d(r,{default:function(){return X}});var s=t(6252);function i(e,r,t,i,n,o){return i.store.user.email?((0,s.wg)(),(0,s.j4)(i["TheTools"],{key:1})):((0,s.wg)(),(0,s.j4)(i["TheError"],{key:0,code:403,message:"Forbidden"}))}var n=t(2625),o=t(4163),u=t(9963),l=t(3577),a=function(e){return(0,s.dD)("data-v-670c7396"),e=e(),(0,s.Cn)(),e},c=(0,s.Uk)("На главную"),d={class:"container"},m={class:"tools"},v=a((function(){return(0,s._)("h1",{class:"tools_title"},"Инструменты",-1)})),f={class:"tools_item"},_=["onSubmit"],g=a((function(){return(0,s._)("div",null,"Service account email",-1)})),p=a((function(){return(0,s._)("div",null,"Service account private key",-1)})),h=a((function(){return(0,s._)("div",null,"Sheet ID",-1)})),b={class:"buttons"},y=(0,s.Uk)("Сохранить"),w={class:"message"},k={class:"tools_item"},S={key:0,class:"item_sheets"},T={class:"sheets_block"},P=a((function(){return(0,s._)("div",{class:"block_title"},"Выгрузить все",-1)})),q={class:"buttons"},U=(0,s.Uk)("Сформировать"),j={class:"message"},A={class:"sheets_block"},L=a((function(){return(0,s._)("div",{class:"block_title"},"Выгрузить по району",-1)})),C={class:"buttons"},Z=(0,s.Uk)("Сформировать"),Q={class:"message"},F={class:"sheets_block"},G=a((function(){return(0,s._)("div",{class:"block_title"},"Выгрузить по году",-1)})),V={class:"block_year"},x={class:"buttons"},I=(0,s.Uk)("Сформировать"),E={class:"message"},z={key:0,class:"sheets_block"},W=["href"];function $(e,r,t,i,n,o){var a=(0,s.up)("v-button"),$=(0,s.up)("v-loading-wheel"),D=(0,s.up)("v-select");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(a,{class:"home_button",onClick:r[0]||(r[0]=function(r){return e.$router.push("/")})},{default:(0,s.w5)((function(){return[c]})),_:1}),(0,s._)("div",d,[(0,s._)("ul",m,[v,(0,s._)("li",f,[(0,s._)("div",{class:"item_title",onClick:r[1]||(r[1]=function(e){return i.setVisible("integrate")})},"Настроить интеграцию с Google Sheets"),i.tools.integrate?((0,s.wg)(),(0,s.iD)("form",{key:0,class:"item_form",onSubmit:(0,u.iM)(i.setGoogleApi,["prevent"])},[g,(0,s.wy)((0,s._)("input",{class:"form_input","onUpdate:modelValue":r[2]||(r[2]=function(e){return i.googleApi.serviceUser=e})},null,512),[[u.nr,i.googleApi.serviceUser]]),p,(0,s.wy)((0,s._)("input",{class:"form_input","onUpdate:modelValue":r[3]||(r[3]=function(e){return i.googleApi.servicePrivateKey=e})},null,512),[[u.nr,i.googleApi.servicePrivateKey]]),h,(0,s.wy)((0,s._)("input",{class:"form_input","onUpdate:modelValue":r[4]||(r[4]=function(e){return i.googleApi.sheetId=e})},null,512),[[u.nr,i.googleApi.sheetId]]),(0,s._)("div",b,[(0,s.Wm)(a,{type:"submit",disabled:!i.googleApi.serviceUser||!i.googleApi.servicePrivateKey||!i.googleApi.sheetId},{default:(0,s.w5)((function(){return[y]})),_:1},8,["disabled"]),i.googleApi.isLoading?((0,s.wg)(),(0,s.j4)($,{key:0})):(0,s.kq)("",!0),(0,s._)("div",w,(0,l.zw)(i.googleApi.message),1)])],40,_)):(0,s.kq)("",!0)]),(0,s._)("li",k,[(0,s._)("div",{class:"item_title",onClick:r[5]||(r[5]=function(e){return i.setVisible("sheets")})},"Выгрузить заявки в Google Sheets"),i.tools.sheets?((0,s.wg)(),(0,s.iD)("ul",S,[(0,s._)("li",T,[P,(0,s._)("div",q,[(0,s.Wm)(a,{onClick:r[6]||(r[6]=function(e){return i.saveFormsToSheet(i.formsQueries.all)}),disabled:i.isFormsLoading},{default:(0,s.w5)((function(){return[U]})),_:1},8,["disabled"]),i.formsQueries.all.isLoading?((0,s.wg)(),(0,s.j4)($,{key:0})):(0,s.kq)("",!0),(0,s._)("div",j,(0,l.zw)(i.formsQueries.all.message),1)])]),(0,s._)("li",A,[L,(0,s.Wm)(D,{modelValue:i.formsQueries.district.query,"onUpdate:modelValue":r[7]||(r[7]=function(e){return i.formsQueries.district.query=e}),style:{width:"inherit"}},null,8,["modelValue"]),(0,s._)("div",C,[(0,s.Wm)(a,{onClick:r[8]||(r[8]=function(e){return i.saveFormsToSheet(i.formsQueries.district)}),disabled:"Район"===i.formsQueries.district.query||i.isFormsLoading},{default:(0,s.w5)((function(){return[Z]})),_:1},8,["disabled"]),i.formsQueries.district.isLoading?((0,s.wg)(),(0,s.j4)($,{key:0})):(0,s.kq)("",!0),(0,s._)("div",Q,(0,l.zw)(i.formsQueries.district.message),1)])]),(0,s._)("li",F,[G,(0,s._)("div",V,[(0,s.wy)((0,s._)("input",{class:"year_interval","onUpdate:modelValue":r[9]||(r[9]=function(e){return i.min=e}),type:"number",placeholder:"С"},null,512),[[u.nr,i.min]]),(0,s.wy)((0,s._)("input",{class:"year_interval","onUpdate:modelValue":r[10]||(r[10]=function(e){return i.max=e}),type:"number",placeholder:"По"},null,512),[[u.nr,i.max]])]),(0,s._)("div",x,[(0,s.Wm)(a,{onClick:r[11]||(r[11]=function(e){return i.saveFormsToSheet(i.formsQueries.birth)}),disabled:String(i.min).length<4||String(i.max).length<4||i.isFormsLoading},{default:(0,s.w5)((function(){return[I]})),_:1},8,["disabled"]),i.formsQueries.birth.isLoading?((0,s.wg)(),(0,s.j4)($,{key:0})):(0,s.kq)("",!0),(0,s._)("div",E,(0,l.zw)(i.formsQueries.birth.message),1)])]),i.link?((0,s.wg)(),(0,s.iD)("li",z,[(0,s._)("a",{class:"sheets_link",target:"_blank",href:i.link},"Ссылка на выгруженные заявки",8,W)])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])])])],64)}var D=t(655),J=t(2262),K=t(6442),O=t(9879),H=(0,s.aZ)({__name:"TheTools",setup:function(e,r){var t=this,i=r.expose;i();var n=(0,J.qj)({integrate:!1,sheets:!1}),o=function(e){n[e]=!n[e]},u=(0,J.qj)({serviceUser:"",servicePrivateKey:"",sheetId:"",message:"",isLoading:!1}),l=function(){return(0,D.mG)(t,void 0,void 0,(function(){var e,r,t,s;return(0,D.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),u.isLoading=!0,[4,O.Z.setGoogleServiceAccountSettings(u.serviceUser,u.servicePrivateKey,u.sheetId)];case 1:return e=i.sent(),u.message=e.data.message,u.serviceUser="",u.servicePrivateKey="",u.sheetId="",[3,4];case 2:return r=i.sent(),u.message=null===(s=null===(t=null===r||void 0===r?void 0:r.response)||void 0===t?void 0:t.data)||void 0===s?void 0:s.message,[3,4];case 3:return u.isLoading=!1,setTimeout((function(){return u.message=""}),3e3),[7];case 4:return[2]}}))}))},a=(0,J.iH)(""),c=(0,J.iH)("");(0,s.YP)([a,c],(function(){String(a.value).length>4&&(a.value=String(a.value).slice(0,4)),String(c.value).length>4&&(c.value=String(c.value).slice(0,4))}));var d=(0,J.iH)(!1),m=(0,J.qj)({all:{filter:"all",query:"all",isLoading:!1,message:""},district:{filter:"district",query:"Район",isLoading:!1,message:""},birth:{filter:"birth",query:(0,s.Fl)((function(){return a.value+"-"+c.value})),isLoading:!1,message:""}}),v=(0,J.iH)(""),f=function(e){return(0,D.mG)(t,void 0,void 0,(function(){var r,t;return(0,D.Jh)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,3,4]),v.value="",e.isLoading=!0,d.value=!0,[4,K.Z.saveFormsToSheet(e.filter,e.query)];case 1:return r=s.sent(),e.message=r.data.message,v.value=r.data.link,[3,4];case 2:return t=s.sent(),console.log(t),e.message=t.response.data.message,setTimeout((function(){return e.message=""}),2e3),[3,4];case 3:return d.value=!1,e.isLoading=!1,setTimeout((function(){return e.message=""}),2e3),[7];case 4:return[2]}}))}))},_={tools:n,setVisible:o,googleApi:u,setGoogleApi:l,min:a,max:c,isFormsLoading:d,formsQueries:m,link:v,saveFormsToSheet:f,ref:J.iH,reactive:J.qj,computed:s.Fl,watch:s.YP,AssistanceService:K.Z,ToolsService:O.Z};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),N=t(3744);const Y=(0,N.Z)(H,[["render",$],["__scopeId","data-v-670c7396"]]);var M=Y,R=(0,s.aZ)({__name:"ToolsView",setup:function(e,r){var t=r.expose;t();var s=(0,n.o)(),i={store:s,useStore:n.o,TheError:o["default"],TheTools:M};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}});const B=(0,N.Z)(R,[["render",i]]);var X=B}}]);
//# sourceMappingURL=571.474af727.js.map