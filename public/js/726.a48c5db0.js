"use strict";(self["webpackChunktg_bot_client_app"]=self["webpackChunktg_bot_client_app"]||[]).push([[726,163],{9879:function(e,t,i){var s=i(655),r=i(100),n=function(){function e(){}return Object.defineProperty(e,"setNewName",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(t){return[2,r.Z.patch("/tools/name",{name:e})]}))}))}}),Object.defineProperty(e,"setNewEmail",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(t){return[2,r.Z.patch("/tools/email",{email:e})]}))}))}}),Object.defineProperty(e,"setNewPassword",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(i){return[2,r.Z.patch("/tools/password",{newPassword:e,oldPassword:t})]}))}))}}),Object.defineProperty(e,"setGoogleServiceAccountSettings",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(s){return[2,r.Z.post("/tools/google/service",{serviceUser:e,servicePrivateKey:t,sheetId:i})]}))}))}}),Object.defineProperty(e,"giveAdminRights",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(t){return[2,r.Z.post("/tools/giverights",{email:e})]}))}))}}),Object.defineProperty(e,"takeAdminRights",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(t){return[2,r.Z.post("/tools/takerights",{email:e})]}))}))}}),e}();t["Z"]=n},4163:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var s=i(6252),r=i(3577),n=(0,s.Uk)("На главную");function o(e,t,i,o,a,l){var u=(0,s.up)("v-button");return(0,s.wg)(),(0,s.iD)("div",{class:(0,r.C_)(e.$style.error)},[(0,s._)("div",{class:(0,r.C_)(e.$style.error_info)},[(0,s._)("div",{class:(0,r.C_)(e.$style.error_code)},(0,r.zw)(i.code),3),(0,s._)("div",{class:(0,r.C_)(e.$style.error_text)},(0,r.zw)(i.message),3),(0,s.Wm)(u,{class:(0,r.C_)(e.$style.error_button),onClick:t[0]||(t[0]=function(t){return e.$router.push("/")})},{default:(0,s.w5)((function(){return[n]})),_:1},8,["class"])],2)],2)}var a=(0,s.aZ)({__name:"TheError",props:{code:{type:[String,Number],required:!0},message:{type:String,required:!0}},setup:function(e,t){var i=t.expose;i();var s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),l={error:"TheError_error_zWRpU",error_info:"TheError_error_info_bRaoI",error_code:"TheError_error_code_p9lzC",error_text:"TheError_error_text_fLubd",error_button:"TheError_error_button_wjtdJ"},u=i(3744);const c={};c["$style"]=l;const d=(0,u.Z)(a,[["render",o],["__cssModules",c]]);var m=d},5726:function(e,t,i){i.r(t),i.d(t,{default:function(){return se}});var s=i(6252);function r(e,t,i,r,n,o){return r.store.isAdmin?((0,s.wg)(),(0,s.j4)(r["TheTools"],{key:1})):((0,s.wg)(),(0,s.j4)(r["TheError"],{key:0,code:403,message:"Forbidden"}))}var n=i(4402),o=i(4163),a=i(9963),l=i(3577),u=function(e){return(0,s.dD)("data-v-7fb54150"),e=e(),(0,s.Cn)(),e},c=(0,s.Uk)("На главную"),d={class:"container"},m={class:"tools"},g=u((function(){return(0,s._)("h1",{class:"tools_title"},"Инструменты",-1)})),f={class:"tools_item"},v=["onSubmit"],h=u((function(){return(0,s._)("div",{class:"form_title"},"Service account email",-1)})),_=u((function(){return(0,s._)("div",{class:"form_title"},"Service account private key",-1)})),p=u((function(){return(0,s._)("div",{class:"form_title"},"Sheet ID",-1)})),b={class:"buttons"},k=(0,s.Uk)("Сохранить"),y={class:"message"},w={class:"tools_item"},V={key:0,class:"item_sheets"},S={key:0,class:"sheets_block"},P={class:"buttons"},q=(0,s.Uk)("Сформировать"),A={class:"message"},L={key:1,class:"sheets_block"},R={class:"buttons"},U=(0,s.Uk)("Сформировать"),T={class:"message"},j={key:2,class:"sheets_block"},Z={class:"block_year"},C={class:"buttons"},W=(0,s.Uk)("Сформировать"),Q={class:"message"},D={key:3,class:"sheets_block"},E=["href"],F={class:"tools_item"},G={key:0,class:"item_form"},I=u((function(){return(0,s._)("div",{class:"form_title"},"Email пользователя",-1)})),O={class:"buttons"},x=(0,s.Uk)("Дать права"),z=(0,s.Uk)("Забрать"),$={class:"message"};function H(e,t,i,r,n,o){var u=(0,s.up)("VButton"),H=(0,s.up)("VInput"),J=(0,s.up)("LoadingWheel"),K=(0,s.up)("VSelect"),N=(0,s.up)("VSelectDistrict");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(u,{class:"home_button",onClick:t[0]||(t[0]=function(t){return e.$router.push("/")})},{default:(0,s.w5)((function(){return[c]})),_:1}),(0,s._)("div",d,[(0,s._)("ul",m,[g,(0,s._)("li",f,[(0,s._)("div",{class:"item_title",onClick:t[1]||(t[1]=function(e){return r.setVisible("integrate")})},"Настроить интеграцию с Google Sheets"),r.tools.integrate?((0,s.wg)(),(0,s.iD)("form",{key:0,class:"item_form",onSubmit:(0,a.iM)(r.setGoogleApi,["prevent"])},[h,(0,s.Wm)(H,{class:"tools_input",modelValue:r.googleApi.serviceUser,"onUpdate:modelValue":t[2]||(t[2]=function(e){return r.googleApi.serviceUser=e}),placeholder:"email"},null,8,["modelValue"]),_,(0,s.Wm)(H,{class:"tools_input",modelValue:r.googleApi.servicePrivateKey,"onUpdate:modelValue":t[3]||(t[3]=function(e){return r.googleApi.servicePrivateKey=e}),placeholder:"key"},null,8,["modelValue"]),p,(0,s.Wm)(H,{class:"tools_input",modelValue:r.googleApi.sheetId,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.googleApi.sheetId=e}),placeholder:"id"},null,8,["modelValue"]),(0,s._)("div",b,[(0,s.Wm)(u,{type:"submit",disabled:!r.googleApi.serviceUser||!r.googleApi.servicePrivateKey||!r.googleApi.sheetId},{default:(0,s.w5)((function(){return[k]})),_:1},8,["disabled"]),r.googleApi.isLoading?((0,s.wg)(),(0,s.j4)(J,{key:0})):(0,s.kq)("",!0),(0,s._)("div",y,(0,l.zw)(r.googleApi.message),1)])],40,v)):(0,s.kq)("",!0)]),(0,s._)("li",w,[(0,s._)("div",{class:"item_title",onClick:t[5]||(t[5]=function(e){return r.setVisible("sheets")})},"Выгрузить заявки в Google Sheets"),r.tools.sheets?((0,s.wg)(),(0,s.iD)("ul",V,[(0,s.Wm)(K,{class:"sheets_select",options:r.selectOptions,title:"Выберите вариант",modelValue:r.selected,"onUpdate:modelValue":t[6]||(t[6]=function(e){return r.selected=e})},null,8,["modelValue"]),"all"===r.selected?((0,s.wg)(),(0,s.iD)("li",S,[(0,s._)("div",P,[(0,s.Wm)(u,{onClick:t[7]||(t[7]=function(e){return r.saveFormsToSheet(r.formsQueries.all)}),disabled:r.isFormsLoading},{default:(0,s.w5)((function(){return[q]})),_:1},8,["disabled"]),r.formsQueries.all.isLoading?((0,s.wg)(),(0,s.j4)(J,{key:0})):(0,s.kq)("",!0),(0,s._)("div",A,(0,l.zw)(r.formsQueries.all.message),1)])])):(0,s.kq)("",!0),"district"===r.selected?((0,s.wg)(),(0,s.iD)("li",L,[(0,s.Wm)(N,{class:"sheets_select",modelValue:r.formsQueries.district.query,"onUpdate:modelValue":t[8]||(t[8]=function(e){return r.formsQueries.district.query=e}),style:{width:"inherit"}},null,8,["modelValue"]),(0,s._)("div",R,[(0,s.Wm)(u,{onClick:t[9]||(t[9]=function(e){return r.saveFormsToSheet(r.formsQueries.district)}),disabled:"Район"===r.formsQueries.district.query||r.isFormsLoading},{default:(0,s.w5)((function(){return[U]})),_:1},8,["disabled"]),r.formsQueries.district.isLoading?((0,s.wg)(),(0,s.j4)(J,{key:0})):(0,s.kq)("",!0),(0,s._)("div",T,(0,l.zw)(r.formsQueries.district.message),1)])])):(0,s.kq)("",!0),"birth"===r.selected?((0,s.wg)(),(0,s.iD)("li",j,[(0,s._)("div",Z,[(0,s.Wm)(H,{class:"year_interval",modelValue:r.min,"onUpdate:modelValue":t[10]||(t[10]=function(e){return r.min=e}),type:"number",placeholder:"С"},null,8,["modelValue"]),(0,s.Wm)(H,{class:"year_interval",modelValue:r.max,"onUpdate:modelValue":t[11]||(t[11]=function(e){return r.max=e}),type:"number",placeholder:"По"},null,8,["modelValue"])]),(0,s._)("div",C,[(0,s.Wm)(u,{onClick:t[12]||(t[12]=function(e){return r.saveFormsToSheet(r.formsQueries.birth)}),disabled:String(r.min).length<4||String(r.max).length<4||r.isFormsLoading},{default:(0,s.w5)((function(){return[W]})),_:1},8,["disabled"]),r.formsQueries.birth.isLoading?((0,s.wg)(),(0,s.j4)(J,{key:0})):(0,s.kq)("",!0),(0,s._)("div",Q,(0,l.zw)(r.formsQueries.birth.message),1)])])):(0,s.kq)("",!0),r.link?((0,s.wg)(),(0,s.iD)("li",D,[(0,s._)("a",{class:"sheets_link",target:"_blank",href:r.link},"Ссылка на выгруженные заявки",8,E)])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)]),(0,s._)("li",F,[(0,s._)("div",{class:"item_title",onClick:t[13]||(t[13]=function(e){return r.setVisible("adminRights")})},"Дать/забрать права админа"),r.tools.adminRights?((0,s.wg)(),(0,s.iD)("form",G,[I,(0,s.Wm)(H,{class:"tools_input",modelValue:r.adminRights.email,"onUpdate:modelValue":t[14]||(t[14]=function(e){return r.adminRights.email=e}),placeholder:"Ваш е-мэйл"},null,8,["modelValue"]),(0,s._)("div",O,[(0,s.Wm)(u,{type:"submit",disabled:!r.Validate.isEmail(r.adminRights.email)||!r.adminRights.email||r.adminRights.isLoading,onClick:r.giveAdminRights},{default:(0,s.w5)((function(){return[x]})),_:1},8,["disabled"]),(0,s.Wm)(u,{type:"submit",disabled:!r.Validate.isEmail(r.adminRights.email)||!r.adminRights.email||r.adminRights.isLoading,onClick:r.takeAdminRights},{default:(0,s.w5)((function(){return[z]})),_:1},8,["disabled"]),r.adminRights.isLoading?((0,s.wg)(),(0,s.j4)(J,{key:0})):(0,s.kq)("",!0)]),(0,s._)("div",$,(0,l.zw)(r.adminRights.message),1)])):(0,s.kq)("",!0)])])])],64)}var J=i(2262),K=i(6442),N=i(9879),Y=i(3177),M=(0,s.aZ)({__name:"TheTools",setup:function(e,t){var i=t.expose;i();var r=(0,J.qj)({integrate:!1,sheets:!1,adminRights:!1});function n(e){r[e]=!r[e]}var o=(0,J.qj)({serviceUser:"",servicePrivateKey:"",sheetId:"",message:"",isLoading:!1});function a(){o.isLoading=!0,N.Z.setGoogleServiceAccountSettings(o.serviceUser,o.servicePrivateKey,o.sheetId).then((function(e){o.message=e.data.message,o.serviceUser="",o.servicePrivateKey="",o.sheetId=""})).catch((function(e){var t,i;o.message=null===(i=null===(t=null===e||void 0===e?void 0:e.response)||void 0===t?void 0:t.data)||void 0===i?void 0:i.message})).finally((function(){o.isLoading=!1,setTimeout((function(){return o.message=""}),3e3)}))}var l=(0,J.iH)(""),u=[{value:"all",name:"Выгрузить все"},{value:"district",name:"Выгрузить по району"},{value:"birth",name:"Выгрузить по году"}],c=(0,J.iH)(""),d=(0,J.iH)("");(0,s.YP)([c,d],(function(){String(c.value).length>4&&(c.value=String(c.value).slice(0,4)),String(d.value).length>4&&(d.value=String(d.value).slice(0,4))}));var m=(0,J.iH)(!1),g=(0,J.qj)({all:{filter:"all",query:"all",isLoading:!1,message:""},district:{filter:"district",query:"Район",isLoading:!1,message:""},birth:{filter:"birth",query:(0,s.Fl)((function(){return c.value+"-"+d.value})),isLoading:!1,message:""}}),f=(0,J.iH)("");function v(e){f.value="",e.isLoading=!0,m.value=!0,K.Z.saveFormsToSheet(e.filter,e.query).then((function(t){e.message=t.data.message,f.value=t.data.link})).catch((function(t){e.message=t.response.data.message})).finally((function(){m.value=!1,e.isLoading=!1,setTimeout((function(){return e.message=""}),2e3)}))}var h=(0,J.qj)({email:"",isLoading:!1,message:""});function _(){h.isLoading=!0,h.message="",N.Z.giveAdminRights(h.email).then((function(e){h.message=e.data.message})).catch((function(e){h.message=e.response.data.message})).finally((function(){h.isLoading=!1}))}function p(){h.isLoading=!0,h.message="",N.Z.takeAdminRights(h.email).then((function(e){h.message=e.data.message})).catch((function(e){h.message=e.response.data.message})).finally((function(){h.isLoading=!1}))}var b={tools:r,setVisible:n,googleApi:o,setGoogleApi:a,selected:l,selectOptions:u,min:c,max:d,isFormsLoading:m,formsQueries:g,link:f,saveFormsToSheet:v,adminRights:h,giveAdminRights:_,takeAdminRights:p,ref:J.iH,reactive:J.qj,computed:s.Fl,watch:s.YP,AssistanceService:K.Z,ToolsService:N.Z,Validate:Y.Z};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),B=i(3744);const X=(0,B.Z)(M,[["render",H],["__scopeId","data-v-7fb54150"]]);var ee=X,te=(0,s.aZ)({__name:"ToolsView",setup:function(e,t){var i=t.expose;i();var s=(0,n.o)(),r={store:s,useStore:n.o,TheError:o["default"],TheTools:ee};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}});const ie=(0,B.Z)(te,[["render",r]]);var se=ie}}]);
//# sourceMappingURL=726.a48c5db0.js.map