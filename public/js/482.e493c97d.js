"use strict";(self["webpackChunktg_bot_client_app"]=self["webpackChunktg_bot_client_app"]||[]).push([[482,163],{9879:function(e,r,t){var s=t(655),i=t(100),o=function(){function e(){}return Object.defineProperty(e,"setNewName",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(r){return[2,i.Z.patch("/tools/name",{name:e})]}))}))}}),Object.defineProperty(e,"setNewEmail",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(r){return[2,i.Z.patch("/tools/email",{email:e})]}))}))}}),Object.defineProperty(e,"setNewPassword",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(t){return[2,i.Z.patch("/tools/password",{newPassword:e,oldPassword:r})]}))}))}}),Object.defineProperty(e,"setGoogleServiceAccountSettings",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r,t){return(0,s.mG)(this,void 0,Promise,(function(){return(0,s.Jh)(this,(function(s){return[2,i.Z.post("/tools/google/service",{serviceUser:e,servicePrivateKey:r,sheetId:t})]}))}))}}),e}();r["Z"]=o},4163:function(e,r,t){t.r(r),t.d(r,{default:function(){return f}});var s=t(6252),i=t(3577),o=(0,s.Uk)("На главную");function n(e,r,t,n,u,a){var l=(0,s.up)("v-button");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(e.$style.error)},[(0,s._)("div",{class:(0,i.C_)(e.$style.error_info)},[(0,s._)("div",{class:(0,i.C_)(e.$style.error_code)},(0,i.zw)(t.code),3),(0,s._)("div",{class:(0,i.C_)(e.$style.error_text)},(0,i.zw)(t.message),3),(0,s.Wm)(l,{class:(0,i.C_)(e.$style.error_button),onClick:r[0]||(r[0]=function(r){return e.$router.push("/")})},{default:(0,s.w5)((function(){return[o]})),_:1},8,["class"])],2)],2)}var u=(0,s.aZ)({__name:"TheError",props:{code:{type:[String,Number],required:!0},message:{type:String,required:!0}},setup:function(e,r){var t=r.expose;t();var s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),a={error:"TheError_error_zWRpU",error_info:"TheError_error_info_bRaoI",error_code:"TheError_error_code_p9lzC",error_text:"TheError_error_text_fLubd",error_button:"TheError_error_button_wjtdJ"},l=t(3744);const c={};c["$style"]=a;const d=(0,l.Z)(u,[["render",n],["__cssModules",c]]);var f=d},1482:function(e,r,t){t.r(r),t.d(r,{default:function(){return N}});var s=t(6252);function i(e,r,t,i,o,n){return i.store.user.email?((0,s.wg)(),(0,s.j4)(i["TheTools"],{key:1})):((0,s.wg)(),(0,s.j4)(i["TheError"],{key:0,code:403,message:"Forbidden"}))}var o=t(2625),n=t(4163),u=t(9963),a=t(3577),l=function(e){return(0,s.dD)("data-v-84b75bea"),e=e(),(0,s.Cn)(),e},c=(0,s.Uk)("На главную"),d={class:"container"},f={class:"tools"},v=l((function(){return(0,s._)("h1",{class:"tools_title"},"Инструменты",-1)})),m={class:"tools_item"},_=["onSubmit"],g=l((function(){return(0,s._)("div",null,"Service account email",-1)})),p=l((function(){return(0,s._)("div",null,"Service account private key",-1)})),h=l((function(){return(0,s._)("div",null,"Sheet ID",-1)})),b={class:"buttons"},y=(0,s.Uk)("Сохранить"),w={class:"message"},k={class:"tools_item"},S={key:0,class:"item_sheets"},T={class:"sheets_block"},P=l((function(){return(0,s._)("div",{class:"block_title"},"Выгрузить все",-1)})),q={class:"buttons"},j=(0,s.Uk)("Сформировать"),A={class:"message"},U={class:"sheets_block"},C=l((function(){return(0,s._)("div",{class:"block_title"},"Выгрузить по району",-1)})),Z={class:"buttons"},L=(0,s.Uk)("Сформировать"),G={class:"message"},I={key:0,class:"sheets_block"},Q=["href"];function V(e,r,t,i,o,n){var l=(0,s.up)("v-button"),V=(0,s.up)("v-loading-wheel"),E=(0,s.up)("v-select");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(l,{class:"home_button",onClick:r[0]||(r[0]=function(r){return e.$router.push("/")})},{default:(0,s.w5)((function(){return[c]})),_:1}),(0,s._)("div",d,[(0,s._)("ul",f,[v,(0,s._)("li",m,[(0,s._)("div",{class:"item_title",onClick:r[1]||(r[1]=function(e){return i.setVisible("integrate")})},"Настроить интеграцию с Google Sheets"),i.tools.integrate?((0,s.wg)(),(0,s.iD)("form",{key:0,class:"item_form",onSubmit:(0,u.iM)(i.setGoogleApi,["prevent"])},[g,(0,s.wy)((0,s._)("input",{class:"form_input","onUpdate:modelValue":r[2]||(r[2]=function(e){return i.googleApi.serviceUser=e})},null,512),[[u.nr,i.googleApi.serviceUser]]),p,(0,s.wy)((0,s._)("input",{class:"form_input","onUpdate:modelValue":r[3]||(r[3]=function(e){return i.googleApi.servicePrivateKey=e})},null,512),[[u.nr,i.googleApi.servicePrivateKey]]),h,(0,s.wy)((0,s._)("input",{class:"form_input","onUpdate:modelValue":r[4]||(r[4]=function(e){return i.googleApi.sheetId=e})},null,512),[[u.nr,i.googleApi.sheetId]]),(0,s._)("div",b,[(0,s.Wm)(l,{type:"submit",disabled:!i.googleApi.serviceUser||!i.googleApi.servicePrivateKey||!i.googleApi.sheetId},{default:(0,s.w5)((function(){return[y]})),_:1},8,["disabled"]),i.googleApi.isLoading?((0,s.wg)(),(0,s.j4)(V,{key:0})):(0,s.kq)("",!0),(0,s._)("div",w,(0,a.zw)(i.googleApi.message),1)])],40,_)):(0,s.kq)("",!0)]),(0,s._)("li",k,[(0,s._)("div",{class:"item_title",onClick:r[5]||(r[5]=function(e){return i.setVisible("sheets")})},"Выгрузить заявки в Google Sheets"),i.tools.sheets?((0,s.wg)(),(0,s.iD)("ul",S,[(0,s._)("li",T,[P,(0,s._)("div",q,[(0,s.Wm)(l,{onClick:r[6]||(r[6]=function(e){return i.saveFormsToSheet(i.formsQueries.all)}),disabled:i.isFormsLoading},{default:(0,s.w5)((function(){return[j]})),_:1},8,["disabled"]),i.formsQueries.all.isLoading?((0,s.wg)(),(0,s.j4)(V,{key:0})):(0,s.kq)("",!0),(0,s._)("div",A,(0,a.zw)(i.formsQueries.all.message),1)])]),(0,s._)("li",U,[C,(0,s.Wm)(E,{modelValue:i.formsQueries.district.query,"onUpdate:modelValue":r[7]||(r[7]=function(e){return i.formsQueries.district.query=e}),style:{width:"inherit"}},null,8,["modelValue"]),(0,s._)("div",Z,[(0,s.Wm)(l,{onClick:r[8]||(r[8]=function(e){return i.saveFormsToSheet(i.formsQueries.district)}),disabled:"Район"===i.formsQueries.district.query||i.isFormsLoading},{default:(0,s.w5)((function(){return[L]})),_:1},8,["disabled"]),i.formsQueries.district.isLoading?((0,s.wg)(),(0,s.j4)(V,{key:0})):(0,s.kq)("",!0),(0,s._)("div",G,(0,a.zw)(i.formsQueries.district.message),1)])]),i.link?((0,s.wg)(),(0,s.iD)("li",I,[(0,s._)("a",{class:"sheets_link",target:"_blank",href:i.link},"Ссылка на выгруженные заявки",8,Q)])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])])])],64)}var E=t(655),F=t(2262),$=t(6442),z=t(9879),D=(0,s.aZ)({__name:"TheTools",setup:function(e,r){var t=this,s=r.expose;s();var i=(0,F.qj)({integrate:!1,sheets:!1}),o=function(e){i[e]=!i[e]},n=(0,F.qj)({serviceUser:"",servicePrivateKey:"",sheetId:"",message:"",isLoading:!1}),u=function(){return(0,E.mG)(t,void 0,void 0,(function(){var e,r,t,s;return(0,E.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),n.isLoading=!0,[4,z.Z.setGoogleServiceAccountSettings(n.serviceUser,n.servicePrivateKey,n.sheetId)];case 1:return e=i.sent(),n.message=e.data.message,n.serviceUser="",n.servicePrivateKey="",n.sheetId="",setTimeout((function(){return n.message=""}),3e3),[3,4];case 2:return r=i.sent(),n.message=null===(s=null===(t=null===r||void 0===r?void 0:r.response)||void 0===t?void 0:t.data)||void 0===s?void 0:s.message,setTimeout((function(){return n.message=""}),3e3),[3,4];case 3:return n.isLoading=!1,[7];case 4:return[2]}}))}))},a=(0,F.iH)(!1),l=(0,F.qj)({all:{filter:"all",query:"all",isLoading:!1,message:""},district:{filter:"district",query:"Район",isLoading:!1,message:""}}),c=(0,F.iH)(""),d=function(e){return(0,E.mG)(t,void 0,void 0,(function(){var r,t;return(0,E.Jh)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,3,4]),c.value="",e.isLoading=!0,a.value=!0,[4,$.Z.saveFormsToSheet(e.filter,e.query)];case 1:return r=s.sent(),e.message=r.data.message,c.value=r.data.link,[3,4];case 2:return t=s.sent(),console.log(t),e.message=t.response.data.message,setTimeout((function(){return e.message=""}),2e3),[3,4];case 3:return a.value=!1,e.isLoading=!1,setTimeout((function(){return e.message=""}),2e3),[7];case 4:return[2]}}))}))},f={tools:i,setVisible:o,googleApi:n,setGoogleApi:u,isFormsLoading:a,formsQueries:l,link:c,saveFormsToSheet:d,ref:F.iH,reactive:F.qj,AssistanceService:$.Z,ToolsService:z.Z};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}}),J=t(3744);const K=(0,J.Z)(D,[["render",V],["__scopeId","data-v-84b75bea"]]);var O=K,W=(0,s.aZ)({__name:"ToolsView",setup:function(e,r){var t=r.expose;t();var s=(0,o.o)(),i={store:s,useStore:o.o,TheError:n["default"],TheTools:O};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}});const x=(0,J.Z)(W,[["render",i]]);var N=x}}]);
//# sourceMappingURL=482.e493c97d.js.map